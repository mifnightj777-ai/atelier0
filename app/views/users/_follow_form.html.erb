<% unless current_user == user %>
  <div id="follow_form" class="mt-4">
    
    <% if current_user.following?(user) %>
      <%= form_with(model: Relationship.find_by(follower_id: current_user.id, followed_id: user.id), html: { method: :delete }) do |f| %>
        <%= f.button class: "group relative px-6 py-2 rounded-full border border-indigo-200 bg-white text-indigo-600 text-xs font-['Poppins'] font-bold tracking-widest hover:bg-red-50 hover:text-red-500 hover:border-red-200 transition-all duration-300 flex items-center gap-2 shadow-sm" do %>
          <span class="group-hover:hidden flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" /></svg>
            Teammate
          </span>
          <span class="hidden group-hover:inline">Unfollow</span>
        <% end %>
      <% end %>

    <% elsif current_user.requesting?(user) %>
      <%= form_with(model: Relationship.find_by(follower_id: current_user.id, followed_id: user.id), html: { method: :delete }) do |f| %>
        <%= f.button class: "px-6 py-2 rounded-full bg-slate-200 text-slate-500 text-xs font-['Poppins'] font-bold tracking-widest hover:bg-red-100 hover:text-red-500 transition-all duration-300 flex items-center gap-2" do %>
          <span class="group-hover:hidden">Requested</span>
          <span class="hidden group-hover:inline">Cancel</span>
        <% end %>
      <% end %>

    <% else %>
      <%= form_with(model: Relationship.new) do |f| %>
        <div><%= hidden_field_tag :followed_id, user.id %></div>
        <%= f.button class: "px-6 py-2 rounded-full bg-indigo-700 text-white text-xs font-['Poppins'] font-bold tracking-widest hover:bg-indigo-800 hover:shadow-lg hover:shadow-indigo-500/30 hover:-translate-y-0.5 transition-all duration-300 flex items-center gap-2" do %>
          <span>Connect</span>
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-4 h-4"><path d="M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z" /></svg>
        <% end %>
      <% end %>
    <% end %>

  </div>
<% end %>